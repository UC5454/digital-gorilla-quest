# Quest 19: 魔法の仕組み

## 🦍 導入

ウホッ！山の頂を制覇したお前に、新たな試練が待っている！
ここは「連鎖の洞窟」——暗闇の中で光る結晶が、連鎖反応を起こして輝いている。
この力の正体こそ「Hooks」だ。
あるイベントが起きた瞬間、自動で別のアクションが発動する——まさに魔法のような仕組みだ！
まずはその全体像を掴め！ウホホ！

## 🎯 目標

- [ ] Hooksの概念（イベント駆動の自動処理）を理解する
- [ ] 5つのイベントタイプを把握する
- [ ] 3つのハンドラー（command / prompt / agent）の違いを理解する

## 📋 やること

1. 以下のコピペをClaude Codeに送信する
2. 返ってきた回答を読み、Hooksの仕組みを理解する
3. `practice/cave/hooks-summary.md` に学んだ内容をまとめる

## 📎 コピペ

```
docs/reference/04_hooks.md を読んで、以下を教えて：
1. Hooksとは何か？一言で説明して
2. どんなイベント（トリガー）がある？全部挙げて
3. command / prompt / agent ハンドラーの違いは？
4. 具体的にどんな場面で使える？3つ例を挙げて
```

## ✅ 成功条件

- [ ] Hooksが「イベント発生時に自動実行される処理」だと説明できる
- [ ] 5つのイベント（PreToolUse, PostToolUse, Notification, Stop, SessionStart）を挙げられる
- [ ] command（シェルコマンド）/ prompt（AIに指示）/ agent（サブエージェント）の違いを説明できる

## 📦 成果物

- `practice/cave/hooks-summary.md`（Hooksの概念まとめ）

## 🍌 報酬

- base_bp: 160
- first_clear_bonus: 32

## 💡 ヒント

### hint_1
Hooksは「もし〜が起きたら、自動で〜を実行する」という仕組みだ。プログラミングのイベントリスナーに近いぞ！

### hint_2
5つのイベント:
- **PreToolUse**: ツール実行「前」に発動（危険なコマンドのブロック等）
- **PostToolUse**: ツール実行「後」に発動（ファイル保存後の自動処理等）
- **Notification**: 通知発生時に発動
- **Stop**: セッション終了時に発動
- **SessionStart**: セッション開始時に発動

### hint_3
3つのハンドラーの違い:
- **command**: シェルコマンドを実行する（`echo`, `wc -l`, `npm run lint` 等）
- **prompt**: AIに追加の指示を送る（「このファイルにセキュリティ問題がないかチェックして」等）
- **agent**: サブエージェントを起動して複雑な処理を任せる

## 📚 学習ポイント

- Hooksは「イベント駆動の自動処理」。手動操作をゼロにする魔法
- イベント5種 x ハンドラー3種の組み合わせで、様々な自動化が実現できる
- commandは高速だが単純、promptは柔軟だが遅い、agentは最強だが重い——使い分けが大事

## 📖 関連リファレンス

docs/reference/04_hooks.md
